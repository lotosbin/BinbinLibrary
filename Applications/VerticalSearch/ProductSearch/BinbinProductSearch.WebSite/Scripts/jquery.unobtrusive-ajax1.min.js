(function(c){function g(a,b){for(var c=window,e=(a||"").split(".");c&&e.length;)c=c[e.shift()];if(typeof c==="function")return c;b.push(a);return Function.constructor.apply(null,b)}function k(a,b,d){var e;d.indexOf("application/x-javascript")===-1&&(e=(a.getAttribute("data-ajax-mode")||"").toUpperCase(),c(a.getAttribute("data-ajax-update")).each(function(a,d){var i;switch(e){case "BEFORE":i=d.firstChild;c("<div />").html(b).contents().each(function(){d.insertBefore(this,i)});break;case "AFTER":c("<div />").html(b).contents().each(function(){d.appendChild(this)});
break;default:c(d).html(b)}}))}function j(a,b){var d,e,f,h;d=a.getAttribute("data-ajax-confirm");if(!d||window.confirm(d)){e=c(a.getAttribute("data-ajax-loading"));h=a.getAttribute("data-ajax-loading-duration")||0;c.extend(b,{type:a.getAttribute("data-ajax-method")||void 0,url:a.getAttribute("data-ajax-url")||void 0,beforeSend:function(c){var b;b=f;b==="GET"||b==="POST"||c.setRequestHeader("X-HTTP-Method-Override",b);b=g(a.getAttribute("data-ajax-begin"),["xhr"]).apply(this,arguments);b!==!1&&e.show(h);
return b},complete:function(){e.hide(h);g(a.getAttribute("data-ajax-complete"),["xhr","status"]).apply(this,arguments)},success:function(b,c,d){k(a,b,d.getResponseHeader("Content-Type")||"text/html");g(a.getAttribute("data-ajax-success"),["data","status","xhr"]).apply(this,arguments)},error:g(a.getAttribute("data-ajax-failure"),["xhr","status","error"])});b.data.push({name:"X-Requested-With",value:"XMLHttpRequest"});f=b.type.toUpperCase();if(!(f==="GET"||f==="POST"))b.type="POST",b.data.push({name:"X-HTTP-Method-Override",
value:f});c.ajax(b)}}c("a[data-ajax=true]").live("click",function(a){a.preventDefault();j(this,{url:this.href,type:"GET",data:[]})});c("form[data-ajax=true] input[type=image]").live("click",function(a){var b=a.target.name,d=c(a.target),e=d.parents("form")[0],d=d.offset();c(e).data("unobtrusiveAjaxClick",[{name:b+".x",value:Math.round(a.pageX-d.left)},{name:b+".y",value:Math.round(a.pageY-d.top)}]);setTimeout(function(){c(e).removeData("unobtrusiveAjaxClick")},0)});c("form[data-ajax=true] :submit").live("click",
function(a){var b=a.target.name,d=c(a.target).parents("form")[0];c(d).data("unobtrusiveAjaxClick",b?[{name:b,value:a.target.value}]:[]);setTimeout(function(){c(d).removeData("unobtrusiveAjaxClick")},0)});c("form[data-ajax=true]").live("submit",function(a){var b=c(this).data("unobtrusiveAjaxClick")||[];a.preventDefault();a=c(this).data("unobtrusiveValidation");if(!a||!a.validate||a.validate())j(this,{url:this.action,type:this.method||"GET",data:b.concat(c(this).serializeArray())})})})(jQuery);